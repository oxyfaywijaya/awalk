-- // Auto Walk Record Fay - SIMPLE VERSION //
-- + 3 Rute Random dari GitHub
-- + Auto Loop tanpa berhenti
-- + PASTI JALAN!

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local HttpService = game:GetService("HttpService")

local player = Players.LocalPlayer
local char = player.Character or player.CharacterAdded:Wait()
local hrp = char:WaitForChild("HumanoidRootPart")
local humanoid = char:WaitForChild("Humanoid")

-- URL Rute
local routeURLs = {
    "https://raw.githubusercontent.com/oxyfaywijaya/awalk/refs/heads/main/rute1",
    "https://raw.githubusercontent.com/oxyfaywijaya/awalk/refs/heads/main/rute2",
    "https://raw.githubusercontent.com/oxyfaywijaya/awalk/refs/heads/main/rute3"
}

-- Variabel
local allRoutes = {}
local isReplaying = false
local replaySpeed = 1.0

-- FUNGSI SEDERHANA UNTUK LOAD RUTE
local function loadRoute(url)
    local success, data = pcall(function()
        local content = game:HttpGet(url)
        return HttpService:JSONDecode(content)
    end)
    
    if success and data and #data > 0 then
        print("‚úì Loaded route with " .. #data .. " frames")
        return data
    else
        warn("‚úó Failed to load route")
        return nil
    end
end

-- LOAD SEMUA RUTE
print("Loading routes from GitHub...")
for i, url in ipairs(routeURLs) do
    local routeData = loadRoute(url)
    if routeData then
        table.insert(allRoutes, {
            data = routeData,
            name = "Rute " .. i,
            weight = (i <= 2) and 70 or 30  -- Rute 1&2:70%, Rute3:30%
        })
    end
end

print("Total routes loaded: " .. #allRoutes)

-- FUNGSI PILIH RUTE RANDOM
local function getRandomRoute()
    if #allRoutes == 0 then return nil end
    
    -- Buat weighted random selection
    local weights = {}
    local totalWeight = 0
    
    for i, route in ipairs(allRoutes) do
        weights[i] = route.weight
        totalWeight = totalWeight + route.weight
    end
    
    local randomNum = math.random(1, totalWeight)
    local currentWeight = 0
    
    for i, weight in ipairs(weights) do
        currentWeight = currentWeight + weight
        if randomNum <= currentWeight then
            return allRoutes[i]
        end
    end
    
    return allRoutes[1]
end

-- FUNGSI REPLAY YANG PASTI JALAN
local function playRoute(routeData)
    if not routeData or #routeData == 0 then return end
    
    print("Playing route dengan " .. #routeData .. " frames")
    
    local startTime = tick()
    local totalTime = 0
    
    -- Hitung total waktu
    for _, frame in ipairs(routeData) do
        if frame.delta then
            totalTime = totalTime + frame.delta
        end
    end
    
    while isReplaying and (tick() - startTime) * replaySpeed < totalTime do
        local currentTime = (tick() - startTime) * replaySpeed
        
        -- Cari frame yang sesuai dengan waktu saat ini
        local accumulatedTime = 0
        for _, frame in ipairs(routeData) do
            if frame.cf and frame.delta then
                accumulatedTime = accumulatedTime + frame.delta
                if currentTime <= accumulatedTime then
                    -- Apply CFrame
                    hrp.CFrame = CFrame.new(unpack(frame.cf))
                    
                    -- Apply WalkSpeed
                    if frame.ws then
                        humanoid.WalkSpeed = frame.ws
                    end
                    
                    -- Apply Jump
                    if frame.jump then
                        humanoid.Jump = true
                    end
                    
                    break
                end
            end
        end
        
        RunService.Heartbeat:Wait()
    end
end

-- FUNGSI LOOP REPLAY
local function startReplayLoop()
    if #allRoutes == 0 then
        print("Tidak ada rute yang dimuat!")
        return
    end
    
    isReplaying = true
    print("=== STARTING REPLAY LOOP ===")
    
    task.spawn(function()
        while isReplaying do
            -- Pilih rute random
            local selectedRoute = getRandomRoute()
            
            if selectedRoute then
                print("Memutar: " .. selectedRoute.name)
                routeLabel.Text = "Playing: " .. selectedRoute.name
                
                -- Mainkan rute
                playRoute(selectedRoute.data)
                
                -- Tunggu sebentar sebelum ganti rute
                if isReplaying then
                    wait(0.1)
                end
            end
        end
        
        print("Replay stopped")
        routeLabel.Text = "Stopped"
    end)
end

-- BUAT UI SEDERHANA
local screenGui = Instance.new("ScreenGui", player.PlayerGui)
screenGui.Name = "SimpleAutoWalk"

local mainFrame = Instance.new("Frame", screenGui)
mainFrame.Size = UDim2.new(0, 250, 0, 200)
mainFrame.Position = UDim2.new(0, 20, 0.5, -100)
mainFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
mainFrame.Active = true
mainFrame.Draggable = true

local title = Instance.new("TextLabel", mainFrame)
title.Size = UDim2.new(1, 0, 0, 30)
title.Text = "AUTO WALK v3.0"
title.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
title.TextColor3 = Color3.new(1, 1, 1)
title.TextScaled = true

-- Tombol Start/Stop
local startBtn = Instance.new("TextButton", mainFrame)
startBtn.Size = UDim2.new(1, -20, 0, 40)
startBtn.Position = UDim2.new(0, 10, 0, 40)
startBtn.Text = "üöÄ START REPLAY"
startBtn.BackgroundColor3 = Color3.fromRGB(0, 170, 0)
startBtn.TextColor3 = Color3.new(1, 1, 1)
startBtn.TextScaled = true

-- Label Status
routeLabel = Instance.new("TextLabel", mainFrame)
routeLabel.Size = UDim2.new(1, -20, 0, 30)
routeLabel.Position = UDim2.new(0, 10, 0, 90)
routeLabel.Text = "Status: Ready"
routeLabel.BackgroundColor3 = Color3.fromRGB(40, 40, 60)
routeLabel.TextColor3 = Color3.new(1, 1, 1)
routeLabel.TextScaled = true

-- Info Label
local infoLabel = Instance.new("TextLabel", mainFrame)
infoLabel.Size = UDim2.new(1, -20, 0, 30)
infoLabel.Position = UDim2.new(0, 10, 0, 130)
infoLabel.Text = "Rute: " .. #allRoutes .. " loaded"
infoLabel.BackgroundTransparency = 1
infoLabel.TextColor3 = Color3.new(0, 1, 0)
infoLabel.TextScaled = true

-- Speed Control
local speedFrame = Instance.new("Frame", mainFrame)
speedFrame.Size = UDim2.new(1, -20, 0, 40)
speedFrame.Position = UDim2.new(0, 10, 0, 165)
speedFrame.BackgroundColor3 = Color3.fromRGB(40, 40, 40)

local speedMinus = Instance.new("TextButton", speedFrame)
speedMinus.Size = UDim2.new(0.3, 0, 1, 0)
speedMinus.Text = "‚¨Ö SLOW"
speedMinus.BackgroundColor3 = Color3.fromRGB(70, 70, 70)
speedMinus.TextColor3 = Color3.new(1, 1, 1)

local speedLabel = Instance.new("TextLabel", speedFrame)
speedLabel.Size = UDim2.new(0.4, 0, 1, 0)
speedLabel.Position = UDim2.new(0.3, 0, 0, 0)
speedLabel.Text = "Speed: x" .. replaySpeed
speedLabel.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
speedLabel.TextColor3 = Color3.new(1, 1, 1)

local speedPlus = Instance.new("TextButton", speedFrame)
speedPlus.Size = UDim2.new(0.3, 0, 1, 0)
speedPlus.Position = UDim2.new(0.7, 0, 0, 0)
speedPlus.Text = "FAST ‚û°"
speedPlus.BackgroundColor3 = Color3.fromRGB(70, 70, 70)
speedPlus.TextColor3 = Color3.new(1, 1, 1)

-- EVENT HANDLERS
startBtn.MouseButton1Click:Connect(function()
    if isReplaying then
        isReplaying = false
        startBtn.Text = "üöÄ START REPLAY"
        startBtn.BackgroundColor3 = Color3.fromRGB(0, 170, 0)
        routeLabel.Text = "Stopped"
        humanoid.WalkSpeed = 16
    else
        if #allRoutes == 0 then
            -- Coba load ulang
            print("Reloading routes...")
            allRoutes = {}
            for i, url in ipairs(routeURLs) do
                local routeData = loadRoute(url)
                if routeData then
                    table.insert(allRoutes, {
                        data = routeData,
                        name = "Rute " .. i,
                        weight = (i <= 2) and 70 or 30
                    })
                end
            end
            infoLabel.Text = "Rute: " .. #allRoutes .. " loaded"
        end
        
        if #allRoutes > 0 then
            isReplaying = true
            startBtn.Text = "‚èπ STOP REPLAY"
            startBtn.BackgroundColor3 = Color3.fromRGB(170, 0, 0)
            startReplayLoop()
        else
            routeLabel.Text = "No routes loaded!"
        end
    end
end)

speedMinus.MouseButton1Click:Connect(function()
    replaySpeed = math.max(0.25, replaySpeed - 0.25)
    speedLabel.Text = "Speed: x" .. replaySpeed
end)

speedPlus.MouseButton1Click:Connect(function()
    replaySpeed = math.min(3.0, replaySpeed + 0.25)
    speedLabel.Text = "Speed: x" .. replaySpeed
end)

-- AUTO START (jika ada rute)
task.wait(1)
if #allRoutes > 0 then
    print("Auto starting replay in 2 seconds...")
    task.wait(2)
    if not isReplaying then
        isReplaying = true
        startBtn.Text = "‚èπ STOP REPLAY"
        startBtn.BackgroundColor3 = Color3.fromRGB(170, 0, 0)
        startReplayLoop()
    end
end

print("========================================")
print("AUTO WALK READY!")
print("Loaded " .. #allRoutes .. " routes")
print("Press the button to start/stop")
print("========================================")
